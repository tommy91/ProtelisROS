// Declare the name of this Protelis module
// Just like declaring a Java package, except it ends with this file's name (sans extension)
module arducopter

import java.lang.Math.random

def maxh(field) { maxHood PlusSelf( nbr(field) ) }

let status = self.getArdupilotManager().getStatus();
self.announce("Status: " + status);

if (status == "READY") {
	let c = (2 + random() * (8 - 2));
	self.getArdupilotManager().takeoff(c);
}
else { if (status == "WAITING_TAKEOFF") {
	0
}
else { if (status == "FLYING") {
	let altitudeKey = "altezza";
	let altitude = env.get(altitudeKey,0);
	self.announce("My altitude is " + env.get(altitudeKey,""));
	self.announce("The maximum altitude is " + maxh(env.get(altitudeKey,0)));
}
else { if (status == "LANDED") {
	0
}
else {
	self.announce("Error: Status '" + status + "' unknown!");
}}}}